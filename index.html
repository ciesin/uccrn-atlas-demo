<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>UCCRN Atlas</title>
    
    <!-- Base path configuration -->
    <base href="/uccrn-atlas-demo/" />
    <link rel="icon" href="data:;base64,=" />
    
    <!-- Auth check -->
    <script type="module">
        // Immediate auth check before any content loads
        if (!sessionStorage.getItem("authState")) {
            window.location.href = window.location.origin + "/uccrn-atlas-demo/src/auth/login.html";
        }
    </script>
    
    <!-- Load auth check as module -->
    <script type="module" src="./src/auth/auth-check.js"></script>
    
    <!-- External resources -->
    <link rel="stylesheet" href="https://js.arcgis.com/calcite-components/1.9.2/calcite.css" />
    <script type="module" src="https://js.arcgis.com/calcite-components/1.9.2/calcite.esm.js"></script>
    
    <!-- Analytics -->
    <script type="module">
        import { plausible } from './src/utils/analytics.js';
        window.plausible = plausible;
    </script>
</head>
<body>
    <div id="viewDiv"></div>
    <div id="rightWidgets" class="right-widgets"></div>
    
    <div class="logo-container">
        <span class="logo-text">UCCRN Atlas</span>
        <span class="beta-badge">Beta</span>
    </div>

    <calcite-sheet label="Atlas Options" position="inline-end" display-mode="dock" id="optionsSheet">
        <calcite-panel closable heading="City Solutions Case Study Atlas" id="optionsPanel">
            <calcite-block open heading="">
                <p>Please note that this is a demo of the prototype in development, with limited functionality and a few selected cities: Copenhagen, Durban, Los Angeles, Mexico City, New York City, Rio de Janeiro, and Singapore.</p>
            </calcite-block>
            <calcite-block open heading="App Current Features">
                <div class="feature-list">
                    <p>Interactive map of climate solutions case studies</p>
                    <p>Filter case studies by:</p>
                    <ul>
                        <li>Solution type</li>
                        <li>Provenance</li>
                        <li>Climate intervention approach</li>
                    </ul>
                    <p>Access detailed case information:</p>
                    <ul>
                        <li>Case study descriptions</li>
                        <li>Related documents</li>
                        <li>Publication links</li>
                    </ul>
                    <p>Map customization:</p>
                    <ul>
                        <li>Change basemaps</li>
                        <li>Toggle layer visibility</li>
                        <li>Explore temporal data</li>
                    </ul>
                </div>
            </calcite-block>
            <calcite-block open heading="App Feature Enhancement">
                <div class="feature-list">
                    <ul>
                        <li>Searchable Database (in development)</li>
                        <li>Intelligent/smart search on hundreds/thousands cases(e.g., vector search, AI/ML functions, in long-term planning)</li>
                    </ul>
                </div>
            </calcite-block>
            <calcite-block open heading="Filter by Solutions">
                <calcite-chip-group id="solutionFilters" label="solution-filters" selection-mode="multiple">
                    <!-- Chips will be dynamically added here -->
                </calcite-chip-group>
            </calcite-block>
            <calcite-block open heading="Filter by Provenance">
                <calcite-combobox 
                    label="Provenance" 
                    selection-mode="single" 
                    placeholder="Select provenance"
                    scale="m"
                >
                    <calcite-combobox-item 
                        value="all" 
                        text-label="All"
                        selected
                    ></calcite-combobox-item>
                </calcite-combobox>
            </calcite-block>
            <calcite-block open heading="Filter by Climate Intervention">
                <calcite-combobox 
                    id="climate-intervention"
                    label="Climate Intervention" 
                    selection-mode="single" 
                    placeholder="Select intervention type"
                    scale="m"
                >
                    <calcite-combobox-item 
                        value="all" 
                        text-label="All"
                        selected
                    ></calcite-combobox-item>
                </calcite-combobox>
            </calcite-block>
            <calcite-block open heading="Filter by City Population Size">
                <calcite-combobox 
                    id="population-size"
                    label="Population Size" 
                    selection-mode="single" 
                    placeholder="Select population size"
                    scale="m">
                    <calcite-combobox-item 
                        value="all" 
                        text-label="All"
                        selected
                    ></calcite-combobox-item>
                </calcite-combobox>
            </calcite-block>
            
            <calcite-button slot="footer" width="full" appearance="solid">
                Apply Changes
            </calcite-button>
        </calcite-panel>
    </calcite-sheet>
    <calcite-button id="homeBtn" icon-start="home" label="Home"></calcite-button>
    <calcite-button id="viewSwitchBtn" icon-start="globe" label="3D"></calcite-button>
    <script type="module" src="./src/main.js"></script>
</body>
</html>
